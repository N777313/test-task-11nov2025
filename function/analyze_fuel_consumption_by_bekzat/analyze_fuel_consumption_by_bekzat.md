–≤–æ—Ç –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ postgres. –ü–æ–∫–∞–∂–∏ –º–Ω–µ –ø—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
CREATE OR REPLACE FUNCTION public.analyze_fuel_consumption_by_bekzat(peqmt integer, pstartdate date, pstartshift integer, penddate date, pendshift integer)
 RETURNS fuel_analytics_result_by_bekzat
 LANGUAGE plpgsql
AS $function$
DECLARE
    start_ts TIMESTAMP;
    end_ts TIMESTAMP;
    end_shift_start_ts TIMESTAMP;
    duration_hours NUMERIC;
    fuel_record RECORD;
    last_liters NUMERIC;
    segment_start_level NUMERIC;
    is_first_record BOOLEAN := TRUE;
    
    ANOMALY_THRESHOLD_LITERS NUMERIC := 100;
    
    -- –≠—Ç–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –º–µ–ª–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è ("—à—É–º").
    REFILL_SENSITIVITY_LITERS NUMERIC := 40;

    result_data public.fuel_analytics_result_by_bekzat;
BEGIN
    -- 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    result_data.total_consumption_liters := 0;
    result_data.total_refilled_liters := 0;
    result_data.refills_count := 0;
    result_data.anomalous_drops_count := 0;
    -- ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...
    result_data.avg_consumption_lph := 0;
    result_data.start_fuel_level := NULL;
    result_data.end_fuel_level := NULL;
    result_data.data_points_processed := 0;

    -- 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü
    SELECT shiftstart INTO start_ts FROM shifts WHERE shiftdate = pstartdate AND shift = pstartshift;
    IF NOT FOUND THEN RETURN result_data; END IF;
    SELECT shiftstart INTO end_shift_start_ts FROM shifts WHERE shiftdate = penddate AND shift = pendshift;
    IF NOT FOUND THEN RETURN result_data; END IF;
    SELECT MIN(shiftstart) INTO end_ts FROM shifts WHERE shiftstart > end_shift_start_ts;
    IF end_ts IS NULL THEN
        end_ts := end_shift_start_ts + INTERVAL '12 hours';
    END IF;

    -- 3. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
    FOR fuel_record IN
        SELECT liters FROM history_fuel
        WHERE eqmt = peqmt
          AND to_timestamp(time_created / 1000.0) >= start_ts
          AND to_timestamp(time_created / 1000.0) < end_ts
        ORDER BY time_created ASC
    LOOP
        result_data.data_points_processed := result_data.data_points_processed + 1;

        IF is_first_record THEN
            result_data.start_fuel_level := fuel_record.liters;
            last_liters := fuel_record.liters;
            segment_start_level := fuel_record.liters;
            is_first_record := FALSE;
            CONTINUE;
        END IF;

        DECLARE
            -- –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—á–∏—Ç–∞–µ–º –ø—Ä–∏—Ä–æ—Å—Ç (–±—É–¥–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ —Ä–∞—Å—Ö–æ–¥–µ)
            increase NUMERIC := fuel_record.liters - last_liters;
        BEGIN
            IF increase > REFILL_SENSITIVITY_LITERS THEN -- –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–∞—è –∑–∞–ø—Ä–∞–≤–∫–∞, –∞ –Ω–µ —à—É–º
                -- –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–µ–≥–º–µ–Ω—Ç —Ä–∞—Å—Ö–æ–¥–∞
                result_data.total_consumption_liters := result_data.total_consumption_liters + (segment_start_level - last_liters);
                
                -- –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                result_data.total_refilled_liters := result_data.total_refilled_liters + increase;
                result_data.refills_count := result_data.refills_count + 1;
                
                -- –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç
                segment_start_level := fuel_record.liters;
            
            ELSIF increase < 0 THEN -- –ï—Å–ª–∏ —ç—Ç–æ —Ä–∞—Å—Ö–æ–¥
                DECLARE
                    drop_amount NUMERIC := -increase;
                BEGIN
                    IF drop_amount > ANOMALY_THRESHOLD_LITERS THEN
                        result_data.anomalous_drops_count := result_data.anomalous_drops_count + 1;
                    END IF;
                END;
            END IF;
            -- –ï—Å–ª–∏ 'increase' –º–µ–∂–¥—É 0 –∏ 'REFILL_SENSITIVITY_LITERS', –º—ã –µ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –Ω–æ last_liters –≤—Å–µ —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º
        END;

        last_liters := fuel_record.liters;
    END LOOP;

    -- 4. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
    IF NOT is_first_record THEN
        IF segment_start_level > last_liters THEN
             result_data.total_consumption_liters := result_data.total_consumption_liters + (segment_start_level - last_liters);
        END IF;
        result_data.end_fuel_level := last_liters;
    END IF;

    -- 5. –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
    duration_hours := EXTRACT(EPOCH FROM (end_ts - start_ts)) / 3600.0;
    IF duration_hours > 0 AND result_data.total_consumption_liters > 0 THEN
        result_data.avg_consumption_lph := result_data.total_consumption_liters / duration_hours;
    END IF;

    RETURN result_data;
END;
$function$
;


# answer:
–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å üëç
–†–∞–∑–±–µ—Ä—ë–º —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é **–ø–æ—à–∞–≥–æ–≤–æ –∏ –ø–æ –ª–æ–≥–∏–∫–µ**, –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏.

---

## üß† –û–±—â–∞—è –∏–¥–µ—è

–§—É–Ω–∫—Ü–∏—è `analyze_fuel_consumption_by_bekzat(...)` ‚Äî —ç—Ç–æ **–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ä–∞—Å—Ö–æ–¥–∞ —Ç–æ–ø–ª–∏–≤–∞ —Ç–µ—Ö–Ω–∏–∫–∏** –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ–∂–¥—É —Å–º–µ–Ω–∞–º–∏).

–û–Ω–∞ –±–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `history_fuel`, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —É—Ä–æ–≤–Ω–∏ —Ç–æ–ø–ª–∏–≤–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ –ø–æ —ç—Ç–∏–º –¥–∞–Ω–Ω—ã–º —Å—á–∏—Ç–∞–µ—Ç:

* —Å–∫–æ–ª—å–∫–æ —Ç–æ–ø–ª–∏–≤–∞ **–ø–æ—Ç—Ä–∞—á–µ–Ω–æ (–∏–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–æ)**,
* —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ **–∑–∞–ø—Ä–∞–≤–æ–∫**,
* —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ **–∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Å–∫–∞—á–∫–æ–≤/–ø–∞–¥–µ–Ω–∏–π**,
* –∞ —Ç–∞–∫–∂–µ –≤—ã—á–∏—Å–ª—è–µ—Ç **—Å—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ —á–∞—Å**.

---

## üì• –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ                                           |
| ------------- | ------- | -------------------------------------------------- |
| `peqmt`       | integer | ID —Ç–µ—Ö–Ω–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä, —Å–∞–º–æ—Å–≤–∞–ª –∏ —Ç.–ø.) |
| `pstartdate`  | date    | –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∞                                |
| `pstartshift` | integer | —Å–º–µ–Ω–∞ –Ω–∞—á–∞–ª–∞                                       |
| `penddate`    | date    | –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞                                         |
| `pendshift`   | integer | —Å–º–µ–Ω–∞ –∫–æ–Ω—Ü–∞                                        |

---

## üìä –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Ç–∏–ø–∞ `fuel_analytics_result_by_bekzat`, –≥–¥–µ —Å–æ–±—Ä–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

| –ü–æ–ª–µ                       | –ó–Ω–∞—á–µ–Ω–∏–µ                             |
| -------------------------- | ------------------------------------ |
| `total_consumption_liters` | –æ–±—â–∏–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞                 |
| `total_refilled_liters`    | –æ–±—â–∏–π –æ–±—ä—ë–º –∑–∞–ø—Ä–∞–≤–æ–∫                 |
| `refills_count`            | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–∞–≤–æ–∫                  |
| `anomalous_drops_count`    | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –ø–∞–¥–µ–Ω–∏–π —É—Ä–æ–≤–Ω—è |
| `avg_consumption_lph`      | —Å—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –ª–∏—Ç—Ä–æ–≤ –≤ —á–∞—Å          |
| `start_fuel_level`         | —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞ –≤ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–∏–æ–¥–∞     |
| `end_fuel_level`           | —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞ –≤ –∫–æ–Ω—Ü–µ –ø–µ—Ä–∏–æ–¥–∞      |
| `data_points_processed`    | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö |

---

## ‚öôÔ∏è –ü–æ—à–∞–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É `result_data` –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –ø–æ–ª—è –Ω—É–ª—è–º–∏ –∏–ª–∏ `NULL`.
–≠—Ç–æ ‚Äú–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä‚Äù, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞.

---

### 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü –∞–Ω–∞–ª–∏–∑–∞

–§—É–Ω–∫—Ü–∏—è –∏—â–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ —Ç–∞–±–ª–∏—Ü–µ `shifts`:

```sql
SELECT shiftstart INTO start_ts
FROM shifts WHERE shiftdate = pstartdate AND shift = pstartshift;
```

–¢–æ –∂–µ —Å–∞–º–æ–µ –¥–ª—è –∫–æ–Ω—Ü–∞ (`penddate`, `pendshift`).

–ï—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∞—è —Å–º–µ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ **12 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ** –Ω–∞—á–∞–ª–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–º–µ–Ω—ã.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω**, –∑–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞.

---

### 3. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∞

–î–∞–ª–µ–µ –±–µ—Ä—É—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ —Ç–µ—Ö–Ω–∏–∫–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `history_fuel` –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥:

```sql
SELECT liters
FROM history_fuel
WHERE eqmt = peqmt
  AND timestamp >= start_ts
  AND timestamp < end_ts
ORDER BY time_created ASC
```

–ó–∞—Ç–µ–º –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é —É—Ä–æ–≤–Ω—è —Ç–æ–ø–ª–∏–≤–∞ (`increase = —Ç–µ–∫—É—â–∏–µ –ª–∏—Ç—Ä—ã - –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ª–∏—Ç—Ä—ã`).

---

### 4. –õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–æ–ø–ª–∏–≤–∞

| –£—Å–ª–æ–≤–∏–µ                                     | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è                   | –î–µ–π—Å—Ç–≤–∏–µ                                                                                                                |
| ------------------------------------------- | ------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| `increase > REFILL_SENSITIVITY_LITERS (40)` | –≠—Ç–æ **–∑–∞–ø—Ä–∞–≤–∫–∞**, –Ω–µ –ø—Ä–æ—Å—Ç–æ —à—É–º | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –∑–∞–ø—Ä–∞–≤–æ–∫ –∏ –æ–±—â–∏–π –æ–±—ä—ë–º –∑–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Ç–æ–ø–ª–∏–≤–∞                                                        |
| `increase < 0`                              | –≠—Ç–æ **—Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞**          | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–µ –∞–Ω–æ–º–∞–ª—å–Ω–æ –ª–∏ –±–æ–ª—å—à–æ–µ –ø–∞–¥–µ–Ω–∏–µ (–±–æ–ª–µ–µ `ANOMALY_THRESHOLD_LITERS = 100`), –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å—á—ë—Ç—á–∏–∫ –∞–Ω–æ–º–∞–ª–∏–π |
| `0 ‚â§ increase ‚â§ 40`                         | –≠—Ç–æ ‚Äú—à—É–º‚Äù –∏–ª–∏ –º–µ–ª–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è  | –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å                                                                         |

–ö–∞–∂–¥–∞—è –∑–∞–ø—Ä–∞–≤–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≥—Ä–∞–Ω–∏—Ü–µ–π –º–µ–∂–¥—É ‚Äú—Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ —Ä–∞—Å—Ö–æ–¥–∞‚Äù.

---

### 5. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞

–ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ü–∏–∫–ª–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞—Å—Ö–æ–¥ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–µ–≥–º–µ–Ω—Ç–µ (–æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—Ä–∞–≤–∫–∏ –¥–æ –∫–æ–Ω—Ü–∞ –¥–∞–Ω–Ω—ã—Ö).

–¢–∞–∫–∂–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –∫–æ–Ω–µ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞ (`end_fuel_level`).

---

### 6. –†–∞—Å—á—ë—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –≤ —á–∞—Å–∞—Ö (`duration_hours`)
–∏ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞ –≤ –ª–∏—Ç—Ä–∞—Ö –≤ —á–∞—Å (`avg_consumption_lph`):

```sql
result_data.avg_consumption_lph := total_consumption_liters / duration_hours;
```

---

## üßæ –í –∏—Ç–æ–≥–µ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

* **–°–∫–æ–ª—å–∫–æ —Ç–æ–ø–ª–∏–≤–∞ —Ä–µ–∞–ª—å–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏**
* **–°–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–∞–≤–æ–∫ –±—ã–ª–æ**
* **–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É—Ä–æ–≤–µ–Ω—å —Ä–µ–∑–∫–æ –ø–∞–¥–∞–ª (–∞–Ω–æ–º–∞–ª–∏—è)**
* **–°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ —á–∞—Å**
* **–ù–∞—á–∞–ª—å–Ω—ã–π –∏ –∫–æ–Ω–µ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞**
* **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å—á—ë—Ç–µ**

---

## üß© –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–º —Å–ª—É—á–∞–µ

| –í—Ä–µ–º—è | –õ–∏—Ç—Ä—ã | Œî (–∏–∑–º–µ–Ω–µ–Ω–∏–µ) | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è          |
| ----- | ----- | ------------- | ---------------------- |
| 1000  | 100   | ‚Äî             | —Å—Ç–∞—Ä—Ç                  |
| 1010  | 90    | -10           | —Ä–∞—Å—Ö–æ–¥                 |
| 1020  | 85    | -5            | —Ä–∞—Å—Ö–æ–¥                 |
| 1030  | 140   | +55           | –∑–∞–ø—Ä–∞–≤–∫–∞ (>40)         |
| 1040  | 130   | -10           | —Ä–∞—Å—Ö–æ–¥                 |
| 1050  | 25    | -105          | –∞–Ω–æ–º–∞–ª—å–Ω—ã–π —Å–ø–∞–¥ (>100) |

–†–µ–∑—É–ª—å—Ç–∞—Ç:

* –†–∞—Å—Ö–æ–¥: (100‚àí85) + (140‚àí25) = **130 –ª**
* –ó–∞–ø—Ä–∞–≤–ª–µ–Ω–æ: 55 –ª
* –ó–∞–ø—Ä–∞–≤–æ–∫: 1
* –ê–Ω–æ–º–∞–ª–∏–π: 1
* –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–∏–æ–¥–∞.

---

## üí¨ –í–∫—Ä–∞—Ç—Ü–µ:

–§—É–Ω–∫—Ü–∏—è ‚Äî —ç—Ç–æ **–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–∏–Ω–∞–º–∏–∫–∏ —É—Ä–æ–≤–Ω—è —Ç–æ–ø–ª–∏–≤–∞**:

* –∏—â–µ—Ç –∑–∞–ø—Ä–∞–≤–∫–∏ –∏ —Ä–∞—Å—Ö–æ–¥,
* –∏—Å–∫–ª—é—á–∞–µ—Ç —à—É–º,
* –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ —Ç–æ–ø–ª–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–∏–≤),
* –∏ —Å—á–∏—Ç–∞–µ—Ç –æ–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É —Ç—É –∂–µ –ª–æ–≥–∏–∫—É, –Ω–æ –≤ –≤–∏–¥–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã (–±–ª–æ–∫-—Å—Ö–µ–º–∞ —à–∞–≥–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏)?
